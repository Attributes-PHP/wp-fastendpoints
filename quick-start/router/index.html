
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="FastEndpoints is an elegant way of writing custom WordPress REST endpoints with a focus on readability and IDE auto completion support">
      
      
      
        <link rel="canonical" href="https://wp-fastendpoints.attributes-php.com/quick-start/router/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../service-provider/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Router - WP-FastEndpoints</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="yellow" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#define-the-shape-of-the-data" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="WP-FastEndpoints" class="md-header__button md-logo" aria-label="WP-FastEndpoints" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            WP-FastEndpoints
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Router
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/attributes-php/wp-fastendpoints" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    attributes-php/wp-fastendpoints
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  WP-FastEndpoints

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Quick Start

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../advanced-user-guide/" class="md-tabs__link">
          
  
  
    
  
  Advanced User Guide

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="WP-FastEndpoints" class="md-nav__button md-logo" aria-label="WP-FastEndpoints" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    WP-FastEndpoints
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/attributes-php/wp-fastendpoints" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    attributes-php/wp-fastendpoints
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WP-FastEndpoints
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Quick Start
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Quick Start
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Router
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Router
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#define-the-shape-of-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Define the shape of the data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-post" class="md-nav__link">
    <span class="md-ellipsis">
      Create a post
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#retrieve-a-post" class="md-nav__link">
    <span class="md-ellipsis">
      Retrieve a post
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delete-a-post" class="md-nav__link">
    <span class="md-ellipsis">
      Delete a post
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#everything-together" class="md-nav__link">
    <span class="md-ellipsis">
      Everything together
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../service-provider/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Service Provider
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../tests/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Testing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tests/unit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Unit Tests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tests/integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Integration Tests
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../advanced-user-guide/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Advanced User Guide
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Advanced User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced-user-guide/request-life-cycle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Request Life Cycle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../advanced-user-guide/dependency-injection/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Dependency Injection
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Dependency Injection
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced-user-guide/dependency-injection/request-payload/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Request payload
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced-user-guide/dependency-injection/injectables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Injectables
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced-user-guide/responses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Responses
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced-user-guide/middlewares/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Middlewares
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced-user-guide/plugins-as-dependencies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Treat plugins as dependencies
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#define-the-shape-of-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Define the shape of the data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-post" class="md-nav__link">
    <span class="md-ellipsis">
      Create a post
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#retrieve-a-post" class="md-nav__link">
    <span class="md-ellipsis">
      Retrieve a post
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delete-a-post" class="md-nav__link">
    <span class="md-ellipsis">
      Delete a post
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#everything-together" class="md-nav__link">
    <span class="md-ellipsis">
      Everything together
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Router</h1>

<p>The first thing we need to do is to create a Router.</p>
<div class="highlight"><span class="filename">Api/Routers/Posts.php</span><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="k">use</span> <span class="nx">Attributes\Wp\FastEndpoints\Router</span><span class="p">;</span>

<span class="hll"><span class="nv">$router</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Router</span><span class="p">(</span><span class="s1">&#39;posts&#39;</span><span class="p">);</span>
</span></code></pre></div>
<p>A router is a class which allow us to attach and register endpoints.</p>
<p>An application can have one or multiple routers. One main benefit of using multiple routers is to group endpoints
by same namespace and (optionally) same version. For instance, in this tutorial we are going group all sub-routers,
into another router with a namespace and version <code>my-plugin/v1</code></p>
<h2 id="define-the-shape-of-the-data">Define the shape of the data</h2>
<p>Each endpoint might require different types of data. Thanks to <a href="https://github.com/Attributes-PHP/validation">Attributes-PHP/validation</a>
we can simply create our own PHP classes with the shape of the data we need and use them to validate our request payload
via type-hinting 🤯</p>
<div class="highlight"><span class="filename">Api/Models/Posts.php</span><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="k">namespace</span> <span class="nx">MyPlugin\Api\Models</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Attributes\Options\AliasGenerator</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Attributes\Serialization\SerializableTrait</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Respect\Validation\Rules</span><span class="p">;</span>

<span class="nx">enum</span> <span class="nx">Status</span><span class="o">:</span> <span class="nx">string</span>
<span class="p">{</span>
    <span class="k">case</span> <span class="nx">PUBLISH</span> <span class="o">=</span> <span class="s1">&#39;publish&#39;</span><span class="p">;</span>
    <span class="k">case</span> <span class="nx">DRAFT</span> <span class="o">=</span> <span class="s1">&#39;draft&#39;</span><span class="p">;</span>
    <span class="k">case</span> <span class="k">PRIVATE</span> <span class="o">=</span> <span class="s1">&#39;private&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">#[</span><span class="nd">AliasGenerator</span><span class="p">(</span><span class="s1">&#39;snake&#39;</span><span class="p">)]</span> <span class="c1">#(1)</span>
<span class="k">class</span> <span class="nc">Post</span>
<span class="p">{</span>
    <span class="k">use</span> <span class="nx">SerializableTrait</span><span class="p">;</span> <span class="c1">#(2)</span>

    <span class="p">#[</span><span class="nd">Rules\Positive</span><span class="p">]</span> <span class="c1">#(3)</span>
    <span class="k">public</span> <span class="nx">int</span> <span class="nv">$ID</span><span class="p">;</span>
    <span class="p">#[</span><span class="nd">Rules\Positive</span><span class="p">]</span>
    <span class="k">public</span> <span class="nx">int</span> <span class="nv">$postAuthor</span><span class="p">;</span>
    <span class="k">public</span> <span class="nx">string</span> <span class="nv">$postTitle</span><span class="p">;</span>
    <span class="k">public</span> <span class="nx">Status</span> <span class="nv">$postStatus</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<ol>
<li>Allows looking up for <em>snake</em> case properties e.g. post_author.
   More options at <a href="https://github.com/Attributes-PHP/options">Attributes-PHP/options »</a></li>
<li>Allow us to convert this instance into a dictionary via <code>$instance-&gt;serialize()</code></li>
<li>Supports any <a href="https://respect-validation.readthedocs.io/en/2.4/">Respect Validation</a> rules</li>
</ol>
<h2 id="create-a-post">Create a post</h2>
<p>Let's now create an endpoint which needs this type of data.</p>
<div class="highlight"><span class="filename">Api/Routers/Posts.php</span><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="k">use</span> <span class="nx">MyPlugin\Api\Models\Post</span><span class="p">;</span>

<span class="nv">$router</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nx">Post</span> <span class="c1">#(1) $post, WP_REST_Response #(2) $response) {</span>
    <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">set_status</span><span class="p">(</span><span class="mi">201</span><span class="p">);</span>
    <span class="nv">$payload</span> <span class="o">=</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">serialize</span><span class="p">();</span>

    <span class="k">return</span> <span class="nx">wp_insert_post</span><span class="p">(</span><span class="nv">$payload</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
<span class="p">})</span>
    <span class="o">-&gt;</span><span class="na">hasCap</span><span class="p">(</span><span class="s1">&#39;publish_posts&#39;</span><span class="p">);</span>
</code></pre></div>
<ol>
<li>By default, class-based type-hints will look for the data either in <em><a href="https://developer.wordpress.org/reference/classes/wp_rest_request/get_json_params/">get_json_params</a></em> or
   <em><a href="https://developer.wordpress.org/reference/classes/wp_rest_request/get_body_params/">get_body_params</a></em>. To change
   this behavior see <a href="">Dependency injection</a></li>
<li>Custom dependencies can also be injected via <code>$router-&gt;inject</code>. See <a href="">inject custom dependencies</a></li>
</ol>
<p>When a request is received by this endpoint the following happens:</p>
<ol>
<li>First, the user permissions are checked - ensuring that only users with the <a href="https://wordpress.org/documentation/article/roles-and-capabilities/#publish_posts"><em>publish_posts</em></a> capability are 
   able to trigger this endpoint </li>
<li>Second, if successful, the request payload is validated and populated into an instance of the <code>MyPlugin\Api\Models\Post</code>
   class. By default, <strong>for classes only</strong>, WP-FastEndpoints will look for the data either in
   <a href="https://developer.wordpress.org/reference/classes/wp_rest_request/get_json_params/"><em>get_json_params</em></a> or
   <a href="https://developer.wordpress.org/reference/classes/wp_rest_request/get_body_params/"><em>get_body_params</em></a>, depending on the
   type of request. This behaviour can be changed via attributes though, see <a href="">this page</a> for more info.</li>
<li>Third, the handler is called and creates a new blog post.</li>
</ol>
<h2 id="retrieve-a-post">Retrieve a post</h2>
<p>A great thing of dependency injection is that you only type what you need. And if you only need the ID of a post, so be it 😊</p>
<div class="highlight"><span class="filename">Api/Routers/Posts.php</span><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="k">use</span> <span class="nx">Attributes\Wp\FastEndpoints\Helpers\WpError</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Respect\Validation\Rules</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">MyPlugin\Api\Models\Post</span><span class="p">;</span>

<span class="nv">$router</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;(?P&lt;ID&gt;[\d]+)&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(#[</span><span class="nd">Rules\Positive</span><span class="p">]</span> <span class="c1">#(1) int $ID) {</span>
    <span class="nv">$post</span> <span class="o">=</span> <span class="nx">get_post</span><span class="p">(</span><span class="nv">$ID</span><span class="p">);</span>

    <span class="k">return</span> <span class="nv">$post</span> <span class="o">?:</span> <span class="k">new</span> <span class="nx">WpError</span><span class="p">(</span><span class="mi">404</span><span class="p">,</span> <span class="s1">&#39;Post not found&#39;</span><span class="p">);</span> <span class="c1">#(2)</span>
<span class="p">})</span>
    <span class="o">-&gt;</span><span class="na">returns</span><span class="p">(</span><span class="nx">Post</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">hasCap</span><span class="p">(</span><span class="s1">&#39;read&#39;</span><span class="p">);</span>
</code></pre></div>
<ol>
<li>Yes, endpoint arguments do support any <a href="https://respect-validation.readthedocs.io/en/2.4/">Respect Validation</a> rules</li>
<li><a href="https://github.com/Attributes-PHP/wp-fastendpoints/blob/main/src/Helpers/WpError.php">WpError</a> is simply a subclass
   of WP_Error which automatically set's the HTTP status code on the response data as well</li>
</ol>
<p>When a request is received, the following happens:</p>
<ol>
<li>First, we ensure the user has the <a href="https://wordpress.org/documentation/article/roles-and-capabilities/#read"><em>read</em></a> capability</li>
<li>Second, we ensure that the ID parameter is a valid positive integer. By default, built-in type-hints lookup for
   the data in the following order: 1) <a href="https://developer.wordpress.org/reference/classes/wp_rest_request/get_url_params/"><em>get_url_params</em></a>
   and then 2) <a href="https://developer.wordpress.org/reference/classes/wp_rest_request/get_query_params/"><em>get_query_params</em></a></li>
<li>Lastly, if neither WP_Error or WP_REST_Response is returned by the handler, the <code>returns(Post::class)</code> will ensure
   that the response sent to the client will only contain the fields specified in the <code>MyPlugin\Api\Models\Post</code> class. You
   could also ignore some fields via <code>Attributes\Options\Ignore</code> attribute from <a href="https://github.com/Attributes-PHP/options">Attributes-PHP/options</a></li>
</ol>
<h2 id="delete-a-post">Delete a post</h2>
<p>A common scenario while building API's is to ensure that a user has permissions to a particular resource, in this
case a blog post.</p>
<div class="highlight"><span class="filename">Api/Routers/Posts.php</span><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="k">use</span> <span class="nx">Attributes\Wp\FastEndpoints\Helpers\WpError</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Respect\Validation\Rules</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">MyPlugin\Api\Models\Post</span><span class="p">;</span>

<span class="nv">$router</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">(</span><span class="s1">&#39;(?P&lt;ID&gt;[\d]+)&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(#[</span><span class="nd">Rules\Positive</span><span class="p">]</span> <span class="nx">int</span> <span class="nv">$ID</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">wp_delete_post</span><span class="p">(</span><span class="nv">$ID</span><span class="p">)</span> <span class="o">?:</span> <span class="k">new</span> <span class="nx">WpError</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;Unable to delete post&#39;</span><span class="p">);</span>
<span class="p">})</span>
    <span class="o">-&gt;</span><span class="na">returns</span><span class="p">(</span><span class="nx">Post</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
<span class="hll">    <span class="o">-&gt;</span><span class="na">hasCap</span><span class="p">(</span><span class="s1">&#39;delete_post&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;ID&gt;&#39;</span><span class="p">);</span>
</span></code></pre></div>
<p>In this scenario, only user's with permissions to delete the specific blog post with the provided <code>&lt;ID&gt;</code> would be able
to successfully trigger this endpoint.</p>
<h2 id="everything-together">Everything together</h2>
<div class="highlight"><span class="filename">Api/Routers/Posts.php</span><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="cm">/* Holds REST endpoints to interact with blog posts */</span>

<span class="k">declare</span><span class="p">(</span><span class="nx">strict_types</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>

<span class="k">use</span> <span class="nx">Attributes\Wp\FastEndpoints\Helpers\WpError</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Attributes\Wp\FastEndpoints\Router</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">MyPlugin\Api\Models\Post</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Respect\Validation\Rules</span><span class="p">;</span>

<span class="nv">$router</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Router</span><span class="p">(</span><span class="s1">&#39;posts&#39;</span><span class="p">);</span>

<span class="nv">$router</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nx">Post</span> <span class="nv">$post</span><span class="p">,</span> <span class="nx">WP_REST_Response</span> <span class="nv">$response</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">set_status</span><span class="p">(</span><span class="mi">201</span><span class="p">);</span>
    <span class="nv">$payload</span> <span class="o">=</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">serialize</span><span class="p">();</span>

    <span class="k">return</span> <span class="nx">wp_insert_post</span><span class="p">(</span><span class="nv">$payload</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
<span class="p">})</span>
    <span class="o">-&gt;</span><span class="na">hasCap</span><span class="p">(</span><span class="s1">&#39;publish_posts&#39;</span><span class="p">);</span>

<span class="nv">$router</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;(?P&lt;ID&gt;[\d]+)&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(#[</span><span class="nd">Rules\Positive</span><span class="p">]</span> <span class="nx">int</span> <span class="nv">$ID</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$post</span> <span class="o">=</span> <span class="nx">get_post</span><span class="p">(</span><span class="nv">$ID</span><span class="p">);</span>

    <span class="k">return</span> <span class="nv">$post</span> <span class="o">?:</span> <span class="k">new</span> <span class="nx">WpError</span><span class="p">(</span><span class="mi">404</span><span class="p">,</span> <span class="s1">&#39;Post not found&#39;</span><span class="p">);</span>
<span class="p">})</span>
    <span class="o">-&gt;</span><span class="na">returns</span><span class="p">(</span><span class="nx">Post</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">hasCap</span><span class="p">(</span><span class="s1">&#39;read&#39;</span><span class="p">);</span>

<span class="nv">$router</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">(</span><span class="s1">&#39;(?P&lt;ID&gt;[\d]+)&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(#[</span><span class="nd">Rules\Positive</span><span class="p">]</span> <span class="nx">int</span> <span class="nv">$ID</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">wp_delete_post</span><span class="p">(</span><span class="nv">$ID</span><span class="p">)</span> <span class="o">?:</span> <span class="k">new</span> <span class="nx">WpError</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;Unable to delete post&#39;</span><span class="p">);</span>
<span class="p">})</span>
    <span class="o">-&gt;</span><span class="na">returns</span><span class="p">(</span><span class="nx">Post</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">hasCap</span><span class="p">(</span><span class="s1">&#39;delete_post&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;ID&gt;&#39;</span><span class="p">);</span>

<span class="c1">// IMPORTANT: If no service provider is used make sure to set a version to the $router and call</span>
<span class="c1">//            the following function here:</span>
<span class="c1">// $router-&gt;register();</span>

<span class="c1">// Used later on by the ApiProvider</span>
<span class="k">return</span> <span class="nv">$router</span><span class="p">;</span>
</code></pre></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../" class="md-footer__link md-footer__link--prev" aria-label="Previous: Quick Start">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Quick Start
              </div>
            </div>
          </a>
        
        
          
          <a href="../service-provider/" class="md-footer__link md-footer__link--next" aria-label="Next: Service Provider">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Service Provider
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Attributes-PHP/wp-fastendpoints" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/andre-gil/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "content.tabs.link", "navigation.indexes", "content.tooltips", "navigation.path", "content.code.annotate", "content.code.copy", "content.code.select", "navigation.tabs", "navigation.footer"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>